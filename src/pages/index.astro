---
import { Image } from 'astro:assets'
import { getLangFromUrl, useTranslations } from '@/lib/i18n'
import { Quote } from '@yohn-maistre/astro-pure-fork/advanced'
import { PostPreview } from '@yohn-maistre/astro-pure-fork/components/pages'
import { getBlogCollection, sortMDByDate } from '@yohn-maistre/astro-pure-fork/server'
import { Button, Card, Icon, Label } from '@yohn-maistre/astro-pure-fork/user'

import PageLayout from '@/layouts/BaseLayout.astro'
import BentoGrid from '@/components/bento/BentoGrid.astro'
import Clock from '@/components/home/Clock.tsx'
import ProjectCard from '@/components/home/ProjectCard.astro'
import Section from '@/components/home/Section.astro'
import SkillLayout from '@/components/home/SkillLayout.astro'
import avatar from '@/assets/avatar.png'

import config from '../site.config'

const lang = getLangFromUrl(Astro.url)
const t = useTranslations(lang)

const languages = ['Python', 'HTML', 'CSS', 'JS/TS', 'R', 'MATLAB']
const frontend = ['Next.js', 'TailwindCSS', 'UnoCSS', 'Astro.js', 'Svelte', 'Vite', 'Three.js']
const backend = ['Node.js', 'Bun', 'Django', 'Flask', 'REST', 'FastAPI']
const database = ['PostgreSQL', 'pgVector', 'FAISS', 'Chroma', 'Pinecone', 'Supabase', 'GraphQL']
const machineLearning = ['PyTorch']
const orchestration = [
  'Google ADK',
  'OpenAI Agent SDK',
  'LangGraph',
  'PyDantic',
  'CrewAI',
  'n8n',
  'Weights & Biases',
  'Comet'
]
const infrastructure = ['AWS', 'GCP', 'Vercel', 'Heroku']

const MAX_POSTS = 4
// Filter blog posts by current locale
const allPosts = await getBlogCollection(Astro.currentLocale ?? 'en')
const allPostsByDate = sortMDByDate(allPosts).slice(0, MAX_POSTS)
---

<PageLayout meta={{ title: t('home.title') }} highlightColor='#659EB9'>
  <main class='flex w-full flex-col items-center'>
    <section class='animate mb-10 flex flex-col items-center gap-y-7' id='content-header'>
      <Image
        src={avatar}
        alt='profile'
        class='h-28 w-auto rounded-full border p-1'
        loading='eager'
      />

      <div class='flex flex-col items-center gap-y-4'>
        <h1 class='text-3xl font-bold'>{config.author}</h1>
        <div class='flex flex-wrap justify-center gap-x-7 gap-y-3'>
          <Label title={t('home.location')}>
            <Icon name='location' class='size-5' slot='icon' />
          </Label>
          <!-- <Label title='GitHub' as='a' href='https://github.com/yohn-maistre' target='_blank'>
            <Icon name='github' class='size-5' slot='icon' />
          </Label> -->
          <div class='flex items-center gap-x-2'>
            <!-- <Icon name='clock' class='size-5' /> -->
            <Clock client:visible />
          </div>
        </div>
      </div>

      {/* Link to Abstraksl Website */}
      <a
        href='https://abstraksi.io'
        target='_blank'
        class='flex flex-row items-center gap-x-3 rounded-full border bg-background px-4 py-2 text-sm shadow-sm transition-shadow hover:shadow-md'
      >
        <span class='relative flex items-center justify-center'>
          <span
            class='absolute size-2 animate-ping rounded-full border border-red-400 bg-red-400 opacity-75'
          ></span>
          <span class='size-2 rounded-full bg-red-400'></span>
        </span>
        <p class='font-medium text-muted-foreground'>/Abs•trak•si/</p>
      </a>
    </section>
    <div id='bento' class='animate mb-20 flex flex-col gap-y-10'>
      <BentoGrid />
    </div>

    <div id='content' class='animate flex flex-col gap-y-10 md:w-4/5 lg:w-5/6'>
      <!-- <p class='text-muted-foreground'>Developer / Designer</p> -->
      <!-- <Section title='About'>
        <p class='text-muted-foreground'>
          I build things that connect technology, culture, and everyday life. Currently exploring
          how AI and design can support communities in Papua through /Abstr•aksi/, helping people
          learn, share, and preserve what matters to them. I care about making ideas practical and
          human, turning systems into simple tools that people can actually use and enjoy.
        </p>
        <Button title='More about me' class='w-fit self-end' href='/about' variant='ahead' />
      </Section> -->

      <Section title={t('home.stack')}>
        <SkillLayout title={t('home.stack.languages')} skills={languages} />
        <SkillLayout title={t('home.stack.frontend')} skills={frontend} />
        <SkillLayout title={t('home.stack.backend')} skills={backend} />
        <SkillLayout title={t('home.stack.database')} skills={database} />
        <SkillLayout title={t('home.stack.ml_framework')} skills={machineLearning} />
        <SkillLayout title={t('home.stack.orchestration')} skills={orchestration} />
        <SkillLayout title={t('home.stack.infrastructure')} skills={infrastructure} />
      </Section>

      <!-- <Section title='Projects'>
        <div class='grid grid-cols-1 gap-3 sm:grid-cols-2'>
          <ProjectCard
            href='https://www.youtube.com/watch?v=dQw4w9WgXcQ'
            heading='Lorem ipsum'
            subheading='dolor sit amet, oratio ornatus explicari pro ex'
            imagePath='/src/assets/projects/alex-tyson-2BAXJ7ha74s-unsplash.jpg'
          />
          <ProjectCard
            href='https://www.youtube.com/watch?v=dQw4w9WgXcQ'
            heading='Lorem ipsum'
            subheading='dolor sit amet, oratio ornatus explicari pro ex'
            imagePath='/src/assets/projects/angelica-teran-Bk9hpaXHK4o-unsplash.jpg'
          />
          <ProjectCard
            href='https://www.youtube.com/watch?v=dQw4w9WgXcQ'
            heading='Lorem ipsum'
            subheading='dolor sit amet, oratio ornatus explicari pro ex'
            imagePath='/src/assets/projects/kseniia-zapiatkina-yATU3rg8tNI-unsplash.jpg'
          />
          <ProjectCard
            href='/projects'
            heading='More projects'
            subheading='Check out more projects'
            imagePath='/src/assets/projects/wen-qiao-g_w8I64FiO0-unsplash.jpg'
          />
        </div>
      </Section> -->

      {
        allPostsByDate.length > 0 && (
          <Section title={t('home.posts')}>
            <ul class='flex flex-col gap-y-1.5 sm:gap-y-2'>
              {allPostsByDate.map((p) => (
                <li class='flex flex-col gap-x-2 sm:flex-row'>
                  <PostPreview post={p} detailed />
                </li>
              ))}
            </ul>
            <Button
              title={t('home.more_posts')}
              class='w-fit self-end'
              href='/blog'
              variant='ahead'
            />
          </Section>
        )
      }

      <!-- {
        <Section title='Experience'>
      <Card
        heading='Lorem Ipsum'
        subheading='Sit amet consectetur'
        date='Dec 2022 - Nov 2023'
        imagePath='/src/assets/about-astro.png'
        altText='Lorem, ipsum dolor sit'
        imageClass='h-12 w-auto md:-start-16'
      >
        <ul class='ms-4 list-disc text-muted-foreground'>
          <li>
            Lorem, ipsum dolor sit amet consectetur adipisicing elit. Dolore debitis recusandae, ut
            molestiae laboriosam pariatur!

            <li>Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestiae, pariatur!</li>
          </li>
        </ul>
      </Card>
      <Card
        heading='Lorem Ipsum'
        subheading='Sit amet consectetur'
        date='Dec 2022 - Nov 2023'
        imagePath='/src/assets/about-astro.png'
        altText='Lorem, ipsum dolor sit'
        imageClass='h-12 w-auto md:-start-16'
      />
    </Section>
      } -->
      <!-- <Section title='Education'>
        <Card
          as='a'
          heading='Lorem ipsum'
          subheading='Lorem ipsum dolor sit amet, vidit suscipit at mei.'
          date='August 2021 - July 2025'
          href='https://www.youtube.com/watch?v=dQw4w9WgXcQ'
        >
          {
            /* <ul class='ms-4 list-disc text-muted-foreground'>
          <li>
            Lorem, ipsum dolor sit amet consectetur adipisicing elit. Dolore debitis recusandae, ut
            molestiae laboriosam pariatur!
          </li>
          <li>Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestiae, pariatur!</li>
        </ul> */
          }
        </Card>
      </Section> -->

      <!-- <Section>
        <Card
          as='a'
          heading='Lorem ipsum'
          subheading='Lorem ipsum dolor sit amet, vidit suscipit at mei. Quem denique mea id. Usu ei regione indoctum dissentiunt, cu meliore fuisset mei, vel quod voluptua ne. Ex dicat impedit mel, at eum oratio possit voluptatum. Dicat ceteros cu vim. Impetus fuisset ullamcorper pri cu, his posse iisque ad, aliquam honestatis usu id.'
          date='July 2024'
          href='https://www.youtube.com/watch?v=dQw4w9WgXcQ'
        />
      </Section> -->
    </div>
    <!-- <Quote class='mt-12' /> -->
  </main>
</PageLayout>
